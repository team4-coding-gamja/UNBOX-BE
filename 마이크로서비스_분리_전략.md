# ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì™„ì „ ë¶„ë¦¬ ì „ëµ

## ğŸ“‹ ëª©ì°¨
1. [í˜„ì¬ ìƒí™© ë¶„ì„](#í˜„ì¬-ìƒí™©-ë¶„ì„)
2. [ë¬¸ì œì  ë° ê³¼ì œ](#ë¬¸ì œì -ë°-ê³¼ì œ)
3. [ë¦¬íŒ©í† ë§ ì „ëµ](#ë¦¬íŒ©í† ë§-ì „ëµ)
4. [ì„œë¹„ìŠ¤ ê°„ í†µì‹  íŒ¨í„´](#ì„œë¹„ìŠ¤-ê°„-í†µì‹ -íŒ¨í„´)
5. [ë°ì´í„° ì¼ê´€ì„± ë³´ì¥ ë°©ë²•](#ë°ì´í„°-ì¼ê´€ì„±-ë³´ì¥-ë°©ë²•)
6. [ë‹¨ê³„ë³„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš](#ë‹¨ê³„ë³„-ë§ˆì´ê·¸ë ˆì´ì…˜-ê³„íš)
7. [êµ¬í˜„ ì˜ˆì‹œ](#êµ¬í˜„-ì˜ˆì‹œ)

---

## í˜„ì¬ ìƒí™© ë¶„ì„

### í˜„ì¬ ì•„í‚¤í…ì²˜
- **ëª¨ë†€ë¦¬ì‹ â†’ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì „í™˜ ì¤‘ê°„ ë‹¨ê³„**
- ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©
- ë„ë©”ì¸ ê°„ ì°¸ì¡°ë¥¼ ID ì°¸ì¡° + ìŠ¤ëƒ…ìƒ·ìœ¼ë¡œ ë¶„ë¦¬ ì¤‘

### í˜„ì¬ ë°ì´í„° ì°¸ì¡° ë°©ì‹

#### 1. **ê°™ì€ ë„ë©”ì¸ ë‚´ë¶€**: JPA ì—°ê´€ê´€ê³„ ìœ ì§€
```
Brand (1) â†â†’ (N) Product
Product (1) â†â†’ (N) ProductOption
```

#### 2. **ë‹¤ë¥¸ ë„ë©”ì¸ ê°„**: ID ì°¸ì¡° + ìŠ¤ëƒ…ìƒ·
```java
// Order ì—”í‹°í‹° ì˜ˆì‹œ
@Entity
public class Order {
    // ID ì°¸ì¡°
    private UUID productOptionId;
    private UUID productId;
    private Long sellerId;
    
    // ìŠ¤ëƒ…ìƒ· (ì£¼ë¬¸ ì‹œì  ë°ì´í„°)
    private String productName;
    private String modelNumber;
    private String productOptionName;
    private String productImageUrl;
    private String brandName;
}
```

#### 3. **Feign Client ì¤€ë¹„** (í˜„ì¬ ì£¼ì„ ì²˜ë¦¬)
```java
// @FeignClient(name = "product-service")
public interface ProductClient {
    @GetMapping("/internal/products/options/{id}/for-order")
    ProductOptionForOrderInfoResponse getProductForOrder(@PathVariable UUID id);
}
```

---

## ë¬¸ì œì  ë° ê³¼ì œ

### ğŸ”´ ì™„ì „ ë¶„ë¦¬ ì‹œ ë°œìƒí•˜ëŠ” ë¬¸ì œ

#### 1. **ID ì°¸ì¡°ì˜ ë¬´íš¨í™”**
- ê° ì„œë¹„ìŠ¤ê°€ ë…ë¦½ì ì¸ DBë¥¼ ì‚¬ìš©í•˜ë©´ **Foreign Key ì œì•½ ë¶ˆê°€ëŠ¥**
- ID ì°¸ì¡°ë§Œìœ¼ë¡œëŠ” **ì°¸ì¡° ë¬´ê²°ì„±(Referential Integrity) ë³´ì¥ ë¶ˆê°€**
- ì˜ˆ: `productOptionId`ê°€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ ë¶ˆê°€

#### 2. **ë°ì´í„° ì¼ê´€ì„± ë¬¸ì œ**
- Product ì„œë¹„ìŠ¤ì—ì„œ ìƒí’ˆì´ ì‚­ì œë˜ì–´ë„ Order ì„œë¹„ìŠ¤ëŠ” ì•Œ ìˆ˜ ì—†ìŒ
- ìŠ¤ëƒ…ìƒ· ë°ì´í„°ì™€ ì‹¤ì œ ë°ì´í„°ì˜ ë¶ˆì¼ì¹˜ ë°œìƒ ê°€ëŠ¥

#### 3. **íŠ¸ëœì­ì…˜ ê²½ê³„ ë¬¸ì œ**
- ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì— ê±¸ì¹œ ì‘ì—…ì˜ ì›ìì„± ë³´ì¥ ì–´ë ¤ì›€
- ì˜ˆ: ì£¼ë¬¸ ìƒì„± + ì¬ê³  ì°¨ê°ì´ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ë¶„ì‚°

#### 4. **ì¡°íšŒ ì„±ëŠ¥ ë¬¸ì œ**
- ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•´ì•¼ ì™„ì „í•œ ë°ì´í„° ì¡°íšŒ ê°€ëŠ¥
- N+1 ë¬¸ì œê°€ ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ë¡œ í™•ëŒ€

---

## ë¦¬íŒ©í† ë§ ì „ëµ

### í•µì‹¬ ì›ì¹™

#### âœ… 1. **ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ (Event-Driven Architecture)**
ì„œë¹„ìŠ¤ ê°„ ê°•ê²°í•©ì„ í”¼í•˜ê³  ë¹„ë™ê¸° í†µì‹ ìœ¼ë¡œ ëŠìŠ¨í•œ ê²°í•© ìœ ì§€

#### âœ… 2. **CQRS (Command Query Responsibility Segregation)**
ëª…ë ¹(ì“°ê¸°)ê³¼ ì¡°íšŒ(ì½ê¸°)ë¥¼ ë¶„ë¦¬í•˜ì—¬ ê°ê° ìµœì í™”

#### âœ… 3. **Saga íŒ¨í„´**
ë¶„ì‚° íŠ¸ëœì­ì…˜ì„ ì—¬ëŸ¬ ë‹¨ê³„ì˜ ë¡œì»¬ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¶„í•´

#### âœ… 4. **API Composition vs Data Replication**
ìƒí™©ì— ë”°ë¼ ì‹¤ì‹œê°„ ì¡°íšŒ vs ë°ì´í„° ë³µì œ ì„ íƒ

---

## ì„œë¹„ìŠ¤ ê°„ í†µì‹  íŒ¨í„´

### 1. **ë™ê¸° í†µì‹  (Synchronous)**

#### ì‚¬ìš© ì‹œê¸°
- ì‹¤ì‹œê°„ ë°ì´í„° ê²€ì¦ì´ í•„ìš”í•œ ê²½ìš°
- ì¦‰ê°ì ì¸ ì‘ë‹µì´ í•„ìš”í•œ ê²½ìš°

#### êµ¬í˜„ ë°©ë²•
```java
// Feign Client í™œì„±í™”
@FeignClient(name = "product-service", url = "${services.product.url}")
public interface ProductClient {
    
    @GetMapping("/internal/products/options/{id}/validate")
    ProductValidationResponse validateProductOption(@PathVariable UUID id);
    
    @GetMapping("/internal/products/options/{id}/for-order")
    ProductOptionForOrderInfoResponse getProductForOrder(@PathVariable UUID id);
}
```

#### ì¥ì 
- êµ¬í˜„ì´ ë‹¨ìˆœ
- ì¦‰ê°ì ì¸ ë°ì´í„° ê²€ì¦

#### ë‹¨ì 
- ì„œë¹„ìŠ¤ ê°„ ê²°í•©ë„ ì¦ê°€
- ë„¤íŠ¸ì›Œí¬ ì§€ì—° ë° ì¥ì•  ì „íŒŒ
- ê°€ìš©ì„± ì €í•˜ (ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ì¥ì•  ì‹œ ì˜í–¥)

---

### 2. **ë¹„ë™ê¸° í†µì‹  (Asynchronous) - ì´ë²¤íŠ¸ ê¸°ë°˜**

#### ì‚¬ìš© ì‹œê¸°
- ë°ì´í„° ë™ê¸°í™”ê°€ í•„ìš”í•œ ê²½ìš°
- ìµœì¢… ì¼ê´€ì„±(Eventual Consistency)ìœ¼ë¡œ ì¶©ë¶„í•œ ê²½ìš°

#### êµ¬í˜„ ë°©ë²•

##### A. **ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì‚¬ìš© (Kafka, RabbitMQ)**

```java
// Product ì„œë¹„ìŠ¤: ì´ë²¤íŠ¸ ë°œí–‰
@Service
public class ProductService {
    
    @Autowired
    private KafkaTemplate<String, ProductEvent> kafkaTemplate;
    
    public void deleteProduct(UUID productId) {
        // ìƒí’ˆ ì‚­ì œ
        productRepository.deleteById(productId);
        
        // ì´ë²¤íŠ¸ ë°œí–‰
        ProductDeletedEvent event = new ProductDeletedEvent(
            productId, 
            LocalDateTime.now()
        );
        kafkaTemplate.send("product-events", event);
    }
}

// Order ì„œë¹„ìŠ¤: ì´ë²¤íŠ¸ êµ¬ë…
@Service
public class ProductEventListener {
    
    @KafkaListener(topics = "product-events")
    public void handleProductDeleted(ProductDeletedEvent event) {
        // í•´ë‹¹ ìƒí’ˆê³¼ ì—°ê´€ëœ ì£¼ë¬¸ ì²˜ë¦¬
        orderService.handleProductDeleted(event.getProductId());
    }
}
```

##### B. **ì´ë²¤íŠ¸ íƒ€ì… ì •ì˜**

```java
// ê³µí†µ ì´ë²¤íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
public abstract class DomainEvent {
    private UUID eventId;
    private LocalDateTime occurredAt;
    private String eventType;
}

public class ProductCreatedEvent extends DomainEvent {
    private UUID productId;
    private String productName;
    private String modelNumber;
    private UUID brandId;
    private String brandName;
}

public class ProductUpdatedEvent extends DomainEvent {
    private UUID productId;
    private String productName;
    private String modelNumber;
    private String imageUrl;
}

public class ProductDeletedEvent extends DomainEvent {
    private UUID productId;
}

public class ProductOptionCreatedEvent extends DomainEvent {
    private UUID productOptionId;
    private UUID productId;
    private String optionName;
}
```

#### ì¥ì 
- ì„œë¹„ìŠ¤ ê°„ ëŠìŠ¨í•œ ê²°í•©
- ë†’ì€ ê°€ìš©ì„± (ì„œë¹„ìŠ¤ ë…ë¦½ì  ìš´ì˜)
- í™•ì¥ì„± ìš°ìˆ˜

#### ë‹¨ì 
- ë³µì¡ë„ ì¦ê°€
- ìµœì¢… ì¼ê´€ì„± (ì¦‰ì‹œ ë°˜ì˜ ì•ˆ ë¨)
- ë””ë²„ê¹… ì–´ë ¤ì›€

---

### 3. **í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ (Hybrid)**

ì‹¤ë¬´ì—ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹

#### ì „ëµ
- **ì“°ê¸°(Command)**: ì´ë²¤íŠ¸ ê¸°ë°˜ ë¹„ë™ê¸°
- **ì½ê¸°(Query)**: ë¡œì»¬ ë³µì œ ë°ì´í„° ë˜ëŠ” API ì¡°í•©

```java
// Order ì„œë¹„ìŠ¤ì˜ ë¡œì»¬ Product ì •ë³´ í…Œì´ë¸”
@Entity
@Table(name = "product_read_model")
public class ProductReadModel {
    @Id
    private UUID productId;
    private String productName;
    private String modelNumber;
    private String imageUrl;
    private String brandName;
    private LocalDateTime lastSyncedAt;
}

// ì´ë²¤íŠ¸ ìˆ˜ì‹  ì‹œ ë¡œì»¬ ë³µì œë³¸ ì—…ë°ì´íŠ¸
@Service
public class ProductEventListener {
    
    @KafkaListener(topics = "product-events")
    public void handleProductUpdated(ProductUpdatedEvent event) {
        ProductReadModel readModel = productReadModelRepository
            .findById(event.getProductId())
            .orElse(new ProductReadModel());
            
        readModel.setProductId(event.getProductId());
        readModel.setProductName(event.getProductName());
        readModel.setModelNumber(event.getModelNumber());
        readModel.setImageUrl(event.getImageUrl());
        readModel.setLastSyncedAt(LocalDateTime.now());
        
        productReadModelRepository.save(readModel);
    }
}
```

---

## ë°ì´í„° ì¼ê´€ì„± ë³´ì¥ ë°©ë²•

### 1. **ì°¸ì¡° ë¬´ê²°ì„± ê²€ì¦**

#### A. **ì£¼ë¬¸ ìƒì„± ì‹œ ê²€ì¦**

```java
@Service
public class OrderService {
    
    @Autowired
    private ProductClient productClient;
    
    @Autowired
    private TradeClient tradeClient;
    
    @Transactional
    public OrderResponse createOrder(CreateOrderRequest request) {
        // 1. ìƒí’ˆ ì˜µì…˜ ê²€ì¦ (ë™ê¸° í˜¸ì¶œ)
        ProductValidationResponse productValidation = 
            productClient.validateProductOption(request.getProductOptionId());
            
        if (!productValidation.isValid()) {
            throw new InvalidProductException("ìƒí’ˆ ì˜µì…˜ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
        }
        
        // 2. íŒë§¤ ì…ì°° ê²€ì¦ ë° ì ê¸ˆ
        SellingBidValidationResponse bidValidation = 
            tradeClient.validateAndLockSellingBid(request.getSellingBidId());
            
        if (!bidValidation.isAvailable()) {
            throw new SellingBidNotAvailableException("íŒë§¤ ì…ì°°ì´ ì´ë¯¸ ë§¤ì¹­ë˜ì—ˆìŠµë‹ˆë‹¤");
        }
        
        // 3. ìŠ¤ëƒ…ìƒ· ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        ProductOptionForOrderInfoResponse productInfo = 
            productClient.getProductForOrder(request.getProductOptionId());
        
        // 4. ì£¼ë¬¸ ìƒì„±
        Order order = Order.builder()
            .sellingBidId(request.getSellingBidId())
            .productOptionId(request.getProductOptionId())
            .productId(productInfo.getProductId())
            .productName(productInfo.getProductName())
            .modelNumber(productInfo.getModelNumber())
            .productOptionName(productInfo.getOptionName())
            .productImageUrl(productInfo.getImageUrl())
            .brandName(productInfo.getBrandName())
            .price(bidValidation.getPrice())
            .build();
            
        Order savedOrder = orderRepository.save(order);
        
        // 5. ì£¼ë¬¸ ìƒì„± ì´ë²¤íŠ¸ ë°œí–‰
        publishOrderCreatedEvent(savedOrder);
        
        return OrderMapper.toResponse(savedOrder);
    }
}
```

#### B. **Saga íŒ¨í„´ìœ¼ë¡œ ë¶„ì‚° íŠ¸ëœì­ì…˜ ì²˜ë¦¬**

**Choreography Saga** (ì´ë²¤íŠ¸ ê¸°ë°˜)

```java
// 1. Order Service: ì£¼ë¬¸ ìƒì„± (PENDING ìƒíƒœ)
@Service
public class OrderService {
    
    public void createOrder(CreateOrderRequest request) {
        Order order = new Order();
        order.setStatus(OrderStatus.PENDING);
        orderRepository.save(order);
        
        // ì´ë²¤íŠ¸ ë°œí–‰
        publishEvent(new OrderCreatedEvent(order.getId(), order.getSellingBidId()));
    }
    
    @EventListener
    public void handleSellingBidMatched(SellingBidMatchedEvent event) {
        Order order = orderRepository.findById(event.getOrderId())
            .orElseThrow();
        order.setStatus(OrderStatus.CONFIRMED);
        orderRepository.save(order);
        
        publishEvent(new OrderConfirmedEvent(order.getId()));
    }
    
    @EventListener
    public void handleSellingBidMatchFailed(SellingBidMatchFailedEvent event) {
        Order order = orderRepository.findById(event.getOrderId())
            .orElseThrow();
        order.setStatus(OrderStatus.CANCELLED);
        orderRepository.save(order);
        
        // ë³´ìƒ íŠ¸ëœì­ì…˜
        publishEvent(new OrderCancelledEvent(order.getId()));
    }
}

// 2. Trade Service: íŒë§¤ ì…ì°° ë§¤ì¹­
@Service
public class SellingBidService {
    
    @EventListener
    public void handleOrderCreated(OrderCreatedEvent event) {
        try {
            SellingBid bid = sellingBidRepository
                .findByIdAndStatus(event.getSellingBidId(), SellingStatus.LIVE)
                .orElseThrow();
                
            bid.setStatus(SellingStatus.MATCHED);
            sellingBidRepository.save(bid);
            
            publishEvent(new SellingBidMatchedEvent(
                event.getOrderId(), 
                event.getSellingBidId()
            ));
        } catch (Exception e) {
            publishEvent(new SellingBidMatchFailedEvent(
                event.getOrderId(), 
                event.getSellingBidId(),
                e.getMessage()
            ));
        }
    }
}

// 3. Payment Service: ê²°ì œ ì²˜ë¦¬
@Service
public class PaymentService {
    
    @EventListener
    public void handleOrderConfirmed(OrderConfirmedEvent event) {
        // ê²°ì œ ì¤€ë¹„
        Payment payment = new Payment();
        payment.setOrderId(event.getOrderId());
        payment.setStatus(PaymentStatus.READY);
        paymentRepository.save(payment);
        
        publishEvent(new PaymentReadyEvent(payment.getId(), event.getOrderId()));
    }
}
```

**Orchestration Saga** (ì¤‘ì•™ ì¡°ì •ì)

```java
// Saga Orchestrator
@Service
public class OrderSagaOrchestrator {
    
    @Autowired
    private ProductClient productClient;
    
    @Autowired
    private TradeClient tradeClient;
    
    @Autowired
    private PaymentClient paymentClient;
    
    public void executeOrderSaga(CreateOrderRequest request) {
        SagaInstance saga = new SagaInstance();
        
        try {
            // Step 1: ìƒí’ˆ ê²€ì¦
            saga.addStep(() -> {
                ProductValidationResponse response = 
                    productClient.validateProductOption(request.getProductOptionId());
                if (!response.isValid()) {
                    throw new SagaException("ìƒí’ˆ ê²€ì¦ ì‹¤íŒ¨");
                }
            }, () -> {
                // ë³´ìƒ íŠ¸ëœì­ì…˜ ì—†ìŒ
            });
            
            // Step 2: íŒë§¤ ì…ì°° ë§¤ì¹­
            saga.addStep(() -> {
                tradeClient.matchSellingBid(request.getSellingBidId());
            }, () -> {
                // ë³´ìƒ: íŒë§¤ ì…ì°° ìƒíƒœ ë³µêµ¬
                tradeClient.cancelSellingBidMatch(request.getSellingBidId());
            });
            
            // Step 3: ì£¼ë¬¸ ìƒì„±
            UUID orderId = saga.addStep(() -> {
                return orderService.createOrder(request);
            }, (orderId) -> {
                // ë³´ìƒ: ì£¼ë¬¸ ì·¨ì†Œ
                orderService.cancelOrder(orderId);
            });
            
            // Step 4: ê²°ì œ ì¤€ë¹„
            saga.addStep(() -> {
                paymentClient.preparePayment(orderId, request.getAmount());
            }, () -> {
                // ë³´ìƒ: ê²°ì œ ì·¨ì†Œ
                paymentClient.cancelPayment(orderId);
            });
            
            saga.execute();
            
        } catch (SagaException e) {
            saga.compensate();
            throw e;
        }
    }
}
```

---

### 2. **ë°ì´í„° ë³µì œ (Data Replication)**

#### A. **ì½ê¸° ì „ìš© ë³µì œë³¸ ìœ ì§€**

ê° ì„œë¹„ìŠ¤ê°€ í•„ìš”í•œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì˜ ë°ì´í„°ë¥¼ ë¡œì»¬ì— ë³µì œ

```java
// Order ì„œë¹„ìŠ¤ì˜ Product ì½ê¸° ëª¨ë¸
@Entity
@Table(name = "product_read_model")
public class ProductReadModel {
    @Id
    private UUID productId;
    private String productName;
    private String modelNumber;
    private String imageUrl;
    private String brandName;
    private UUID brandId;
    private LocalDateTime lastSyncedAt;
    private boolean isDeleted;
}

@Entity
@Table(name = "product_option_read_model")
public class ProductOptionReadModel {
    @Id
    private UUID productOptionId;
    private UUID productId;
    private String optionName;
    private LocalDateTime lastSyncedAt;
    private boolean isDeleted;
}

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¡œ ë™ê¸°í™”
@Service
public class ProductSyncService {
    
    @KafkaListener(topics = "product-events")
    public void syncProduct(ProductEvent event) {
        switch (event.getType()) {
            case CREATED:
            case UPDATED:
                ProductReadModel model = productReadModelRepository
                    .findById(event.getProductId())
                    .orElse(new ProductReadModel());
                model.update(event);
                productReadModelRepository.save(model);
                break;
                
            case DELETED:
                productReadModelRepository.findById(event.getProductId())
                    .ifPresent(m -> {
                        m.setDeleted(true);
                        productReadModelRepository.save(m);
                    });
                break;
        }
    }
}
```

#### B. **ì¥ì **
- ì¡°íšŒ ì„±ëŠ¥ ìš°ìˆ˜ (ë¡œì»¬ DB ì¡°íšŒ)
- ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ì¥ì• ì— ì˜í–¥ ì—†ìŒ
- ë³µì¡í•œ ì¡°ì¸ ì¿¼ë¦¬ ê°€ëŠ¥

#### C. **ë‹¨ì **
- ì €ì¥ ê³µê°„ ì¦ê°€
- ë°ì´í„° ë™ê¸°í™” ë³µì¡ë„
- ìµœì¢… ì¼ê´€ì„± (ì‹¤ì‹œê°„ ì•„ë‹˜)

---

### 3. **API Composition**

ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ì¡°í•©

```java
@Service
public class OrderQueryService {
    
    @Autowired
    private OrderRepository orderRepository;
    
    @Autowired
    private ProductClient productClient;
    
    @Autowired
    private UserClient userClient;
    
    public OrderDetailResponse getOrderDetail(UUID orderId) {
        // 1. ì£¼ë¬¸ ê¸°ë³¸ ì •ë³´ ì¡°íšŒ
        Order order = orderRepository.findById(orderId)
            .orElseThrow(() -> new OrderNotFoundException());
        
        // 2. ë³‘ë ¬ë¡œ ì™¸ë¶€ ì„œë¹„ìŠ¤ í˜¸ì¶œ
        CompletableFuture<ProductDetailResponse> productFuture = 
            CompletableFuture.supplyAsync(() -> 
                productClient.getProductDetail(order.getProductId())
            );
            
        CompletableFuture<UserResponse> buyerFuture = 
            CompletableFuture.supplyAsync(() -> 
                userClient.getUser(order.getBuyerId())
            );
            
        CompletableFuture<UserResponse> sellerFuture = 
            CompletableFuture.supplyAsync(() -> 
                userClient.getUser(order.getSellerId())
            );
        
        // 3. ëª¨ë“  í˜¸ì¶œ ì™„ë£Œ ëŒ€ê¸°
        CompletableFuture.allOf(productFuture, buyerFuture, sellerFuture).join();
        
        // 4. ê²°ê³¼ ì¡°í•©
        return OrderDetailResponse.builder()
            .order(order)
            .product(productFuture.join())
            .buyer(buyerFuture.join())
            .seller(sellerFuture.join())
            .build();
    }
}
```

#### ì¥ì 
- í•­ìƒ ìµœì‹  ë°ì´í„°
- ì¶”ê°€ ì €ì¥ ê³µê°„ ë¶ˆí•„ìš”

#### ë‹¨ì 
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë²„í—¤ë“œ
- ì‘ë‹µ ì‹œê°„ ì¦ê°€
- ì„œë¹„ìŠ¤ ì¥ì•  ì „íŒŒ ìœ„í—˜

---

### 4. **Circuit Breaker & Fallback**

ì„œë¹„ìŠ¤ ì¥ì•  ì‹œ ëŒ€ì‘ ì „ëµ

```java
@Service
public class OrderService {
    
    @Autowired
    private ProductClient productClient;
    
    @Autowired
    private ProductReadModelRepository productReadModelRepository;
    
    @CircuitBreaker(name = "product-service", fallbackMethod = "getProductFallback")
    @Retry(name = "product-service")
    public ProductInfo getProductInfo(UUID productId) {
        return productClient.getProduct(productId);
    }
    
    // Fallback: ë¡œì»¬ ë³µì œë³¸ ì‚¬ìš©
    public ProductInfo getProductFallback(UUID productId, Exception e) {
        log.warn("Product service unavailable, using cached data", e);
        
        return productReadModelRepository.findById(productId)
            .map(ProductInfo::from)
            .orElseThrow(() -> new ProductNotFoundException(
                "Product not found in cache: " + productId
            ));
    }
}
```

**application.yml ì„¤ì •**
```yaml
resilience4j:
  circuitbreaker:
    instances:
      product-service:
        registerHealthIndicator: true
        slidingWindowSize: 10
        minimumNumberOfCalls: 5
        permittedNumberOfCallsInHalfOpenState: 3
        waitDurationInOpenState: 10s
        failureRateThreshold: 50
        
  retry:
    instances:
      product-service:
        maxAttempts: 3
        waitDuration: 1s
```

---

## ë‹¨ê³„ë³„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš

### Phase 1: ì¤€ë¹„ ë‹¨ê³„ (í˜„ì¬)
âœ… ë„ë©”ì¸ ê°„ ID ì°¸ì¡° + ìŠ¤ëƒ…ìƒ· ì ìš©  
âœ… Feign Client ì¸í„°í˜ì´ìŠ¤ ì •ì˜  
âœ… ë‚´ë¶€ API ì—”ë“œí¬ì¸íŠ¸ ì¤€ë¹„  

### Phase 2: ì´ë²¤íŠ¸ ì¸í”„ë¼ êµ¬ì¶•
1. **ë©”ì‹œì§€ ë¸Œë¡œì»¤ ë„ì…** (Kafka or RabbitMQ)
2. **ì´ë²¤íŠ¸ ìŠ¤í‚¤ë§ˆ ì •ì˜** (ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬)
3. **ì´ë²¤íŠ¸ ë°œí–‰/êµ¬ë… ê¸°ë³¸ êµ¬ì¡° êµ¬í˜„**

```bash
# Kafka ì„¤ì • ì˜ˆì‹œ
docker-compose.yml:
  kafka:
    image: confluentinc/cp-kafka:latest
    environment:
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092
```

### Phase 3: ì½ê¸° ëª¨ë¸ êµ¬ì¶• (CQRS)
1. **ì½ê¸° ì „ìš© ë³µì œ í…Œì´ë¸” ìƒì„±**
2. **ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ êµ¬í˜„**
3. **ì´ˆê¸° ë°ì´í„° ë™ê¸°í™”**

### Phase 4: Feign Client í™œì„±í™”
1. **ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ êµ¬ì„±** (Eureka or Consul)
2. **Feign Client ì£¼ì„ í•´ì œ**
3. **ë™ê¸° í˜¸ì¶œ ë¡œì§ êµ¬í˜„**
4. **Circuit Breaker ì ìš©**

### Phase 5: ë°ì´í„°ë² ì´ìŠ¤ ë¶„ë¦¬
1. **ì„œë¹„ìŠ¤ë³„ ë…ë¦½ DB êµ¬ì„±**
2. **ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜**
3. **ì—°ê²° ë¬¸ìì—´ ë¶„ë¦¬**

### Phase 6: Saga íŒ¨í„´ ì ìš©
1. **ë¶„ì‚° íŠ¸ëœì­ì…˜ ì‹ë³„**
2. **Saga Orchestrator êµ¬í˜„**
3. **ë³´ìƒ íŠ¸ëœì­ì…˜ ë¡œì§ ì‘ì„±**

### Phase 7: ëª¨ë‹ˆí„°ë§ & ìµœì í™”
1. **ë¶„ì‚° ì¶”ì ** (Zipkin, Jaeger)
2. **ë¡œê·¸ ì§‘ê³„** (ELK Stack)
3. **ë©”íŠ¸ë¦­ ìˆ˜ì§‘** (Prometheus, Grafana)

---

## êµ¬í˜„ ì˜ˆì‹œ

### ì˜ˆì‹œ 1: ì£¼ë¬¸ ìƒì„± í”Œë¡œìš° (ì™„ì „ ë¶„ë¦¬ í›„)

```java
/**
 * ì£¼ë¬¸ ìƒì„± - Saga Orchestration íŒ¨í„´
 */
@Service
@Slf4j
public class OrderCreationSaga {
    
    @Autowired
    private ProductClient productClient;
    
    @Autowired
    private TradeClient tradeClient;
    
    @Autowired
    private UserClient userClient;
    
    @Autowired
    private OrderRepository orderRepository;
    
    @Autowired
    private KafkaTemplate<String, DomainEvent> eventPublisher;
    
    @Transactional
    public OrderResponse createOrder(CreateOrderRequest request, Long buyerId) {
        
        // ========== Step 1: ê²€ì¦ ë‹¨ê³„ (ë™ê¸° í˜¸ì¶œ) ==========
        
        // 1-1. ìƒí’ˆ ì˜µì…˜ ê²€ì¦ ë° ì •ë³´ ì¡°íšŒ
        ProductOptionValidationResponse productValidation = 
            productClient.validateAndGetProductOption(request.getProductOptionId());
            
        if (!productValidation.isValid()) {
            throw new InvalidProductOptionException(
                "ìƒí’ˆ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ íŒë§¤ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤"
            );
        }
        
        // 1-2. íŒë§¤ ì…ì°° ê²€ì¦ ë° ë‚™ê´€ì  ì ê¸ˆ
        SellingBidLockResponse bidLock = 
            tradeClient.tryLockSellingBid(request.getSellingBidId());
            
        if (!bidLock.isLocked()) {
            throw new SellingBidNotAvailableException(
                "íŒë§¤ ì…ì°°ì´ ì´ë¯¸ ë§¤ì¹­ë˜ì—ˆê±°ë‚˜ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤"
            );
        }
        
        // 1-3. êµ¬ë§¤ì ì •ë³´ ê²€ì¦
        UserValidationResponse buyerValidation = 
            userClient.validateUser(buyerId);
            
        if (!buyerValidation.isValid()) {
            // ë³´ìƒ: íŒë§¤ ì…ì°° ì ê¸ˆ í•´ì œ
            tradeClient.unlockSellingBid(request.getSellingBidId(), bidLock.getLockToken());
            throw new InvalidUserException("ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤");
        }
        
        try {
            // ========== Step 2: ì£¼ë¬¸ ìƒì„± (ë¡œì»¬ íŠ¸ëœì­ì…˜) ==========
            
            Order order = Order.builder()
                .id(UUID.randomUUID())
                .sellingBidId(request.getSellingBidId())
                .buyerId(buyerId)
                .sellerId(bidLock.getSellerId())
                .productOptionId(request.getProductOptionId())
                .productId(productValidation.getProductId())
                // ìŠ¤ëƒ…ìƒ· ë°ì´í„°
                .productName(productValidation.getProductName())
                .modelNumber(productValidation.getModelNumber())
                .productOptionName(productValidation.getOptionName())
                .productImageUrl(productValidation.getImageUrl())
                .brandName(productValidation.getBrandName())
                .price(bidLock.getPrice())
                .status(OrderStatus.PENDING_SHIPMENT)
                // ë°°ì†¡ ì •ë³´
                .receiverName(request.getReceiverName())
                .receiverPhone(request.getReceiverPhone())
                .receiverAddress(request.getReceiverAddress())
                .receiverZipCode(request.getReceiverZipCode())
                .build();
                
            Order savedOrder = orderRepository.save(order);
            
            // ========== Step 3: íŒë§¤ ì…ì°° ë§¤ì¹­ í™•ì • (ë™ê¸° í˜¸ì¶œ) ==========
            
            try {
                tradeClient.confirmSellingBidMatch(
                    request.getSellingBidId(), 
                    bidLock.getLockToken(),
                    savedOrder.getId()
                );
            } catch (Exception e) {
                // ë³´ìƒ: ì£¼ë¬¸ ì‚­ì œ
                orderRepository.delete(savedOrder);
                throw new OrderCreationFailedException("íŒë§¤ ì…ì°° ë§¤ì¹­ ì‹¤íŒ¨", e);
            }
            
            // ========== Step 4: ì´ë²¤íŠ¸ ë°œí–‰ (ë¹„ë™ê¸°) ==========
            
            OrderCreatedEvent event = OrderCreatedEvent.builder()
                .eventId(UUID.randomUUID())
                .occurredAt(LocalDateTime.now())
                .orderId(savedOrder.getId())
                .buyerId(buyerId)
                .sellerId(bidLock.getSellerId())
                .productId(productValidation.getProductId())
                .productOptionId(request.getProductOptionId())
                .amount(bidLock.getPrice())
                .build();
                
            eventPublisher.send("order-events", event);
            
            log.info("Order created successfully: {}", savedOrder.getId());
            
            return OrderMapper.toResponse(savedOrder);
            
        } catch (Exception e) {
            // ë³´ìƒ: íŒë§¤ ì…ì°° ì ê¸ˆ í•´ì œ
            tradeClient.unlockSellingBid(request.getSellingBidId(), bidLock.getLockToken());
            throw e;
        }
    }
}
```

---

### ì˜ˆì‹œ 2: ì´ë²¤íŠ¸ ê¸°ë°˜ ë°ì´í„° ë™ê¸°í™”

```java
/**
 * Product ì„œë¹„ìŠ¤: ì´ë²¤íŠ¸ ë°œí–‰
 */
@Service
public class ProductService {
    
    @Autowired
    private ProductRepository productRepository;
    
    @Autowired
    private KafkaTemplate<String, DomainEvent> eventPublisher;
    
    @Transactional
    public ProductResponse updateProduct(UUID productId, UpdateProductRequest request) {
        Product product = productRepository.findById(productId)
            .orElseThrow(() -> new ProductNotFoundException());
            
        // ë³€ê²½ ì „ ë°ì´í„° ì €ì¥ (ì´ë²¤íŠ¸ìš©)
        String oldName = product.getName();
        String oldImageUrl = product.getProductImageUrl();
        
        // ìƒí’ˆ ì •ë³´ ì—…ë°ì´íŠ¸
        product.setName(request.getName());
        product.setModelNumber(request.getModelNumber());
        product.setProductImageUrl(request.getImageUrl());
        
        Product updated = productRepository.save(product);
        
        // ì´ë²¤íŠ¸ ë°œí–‰
        ProductUpdatedEvent event = ProductUpdatedEvent.builder()
            .eventId(UUID.randomUUID())
            .occurredAt(LocalDateTime.now())
            .productId(productId)
            .productName(updated.getName())
            .modelNumber(updated.getModelNumber())
            .imageUrl(updated.getProductImageUrl())
            .brandId(updated.getBrand().getId())
            .brandName(updated.getBrand().getName())
            .previousName(oldName)
            .previousImageUrl(oldImageUrl)
            .build();
            
        eventPublisher.send("product-events", event);
        
        return ProductMapper.toResponse(updated);
    }
}

/**
 * Order ì„œë¹„ìŠ¤: ì´ë²¤íŠ¸ êµ¬ë… ë° ì½ê¸° ëª¨ë¸ ì—…ë°ì´íŠ¸
 */
@Service
@Slf4j
public class ProductEventListener {
    
    @Autowired
    private ProductReadModelRepository productReadModelRepository;
    
    @Autowired
    private OrderRepository orderRepository;
    
    @KafkaListener(topics = "product-events", groupId = "order-service")
    public void handleProductEvent(ProductEvent event) {
        log.info("Received product event: {}", event.getEventType());
        
        switch (event.getEventType()) {
            case "PRODUCT_CREATED":
                handleProductCreated((ProductCreatedEvent) event);
                break;
            case "PRODUCT_UPDATED":
                handleProductUpdated((ProductUpdatedEvent) event);
                break;
            case "PRODUCT_DELETED":
                handleProductDeleted((ProductDeletedEvent) event);
                break;
        }
    }
    
    @Transactional
    public void handleProductCreated(ProductCreatedEvent event) {
        ProductReadModel readModel = ProductReadModel.builder()
            .productId(event.getProductId())
            .productName(event.getProductName())
            .modelNumber(event.getModelNumber())
            .imageUrl(event.getImageUrl())
            .brandId(event.getBrandId())
            .brandName(event.getBrandName())
            .isDeleted(false)
            .lastSyncedAt(LocalDateTime.now())
            .build();
            
        productReadModelRepository.save(readModel);
        log.info("Product read model created: {}", event.getProductId());
    }
    
    @Transactional
    public void handleProductUpdated(ProductUpdatedEvent event) {
        ProductReadModel readModel = productReadModelRepository
            .findById(event.getProductId())
            .orElseGet(() -> {
                log.warn("Product read model not found, creating new one: {}", 
                    event.getProductId());
                return new ProductReadModel();
            });
            
        readModel.setProductId(event.getProductId());
        readModel.setProductName(event.getProductName());
        readModel.setModelNumber(event.getModelNumber());
        readModel.setImageUrl(event.getImageUrl());
        readModel.setBrandName(event.getBrandName());
        readModel.setLastSyncedAt(LocalDateTime.now());
        
        productReadModelRepository.save(readModel);
        log.info("Product read model updated: {}", event.getProductId());
    }
    
    @Transactional
    public void handleProductDeleted(ProductDeletedEvent event) {
        // Soft delete in read model
        productReadModelRepository.findById(event.getProductId())
            .ifPresent(model -> {
                model.setDeleted(true);
                model.setLastSyncedAt(LocalDateTime.now());
                productReadModelRepository.save(model);
            });
            
        // ê´€ë ¨ ì£¼ë¬¸ ì²˜ë¦¬ (ì˜ˆ: ì•Œë¦¼ ë°œì†¡)
        List<Order> relatedOrders = orderRepository
            .findByProductIdAndStatusIn(
                event.getProductId(),
                List.of(OrderStatus.PENDING_SHIPMENT, OrderStatus.SHIPPED_TO_CENTER)
            );
            
        if (!relatedOrders.isEmpty()) {
            log.warn("Product deleted with {} active orders", relatedOrders.size());
            // ì•Œë¦¼ ë°œì†¡ ë“± ì¶”ê°€ ì²˜ë¦¬
        }
    }
}
```

---

### ì˜ˆì‹œ 3: ì¡°íšŒ ìµœì í™” - CQRS íŒ¨í„´

```java
/**
 * ì£¼ë¬¸ ìƒì„¸ ì¡°íšŒ - ë¡œì»¬ ì½ê¸° ëª¨ë¸ ì‚¬ìš©
 */
@Service
public class OrderQueryService {
    
    @Autowired
    private OrderRepository orderRepository;
    
    @Autowired
    private ProductReadModelRepository productReadModelRepository;
    
    @Autowired
    private UserReadModelRepository userReadModelRepository;
    
    /**
     * ë¡œì»¬ ì½ê¸° ëª¨ë¸ë§Œ ì‚¬ìš© (ë¹ ë¦„, ìµœì¢… ì¼ê´€ì„±)
     */
    public OrderDetailResponse getOrderDetail(UUID orderId) {
        Order order = orderRepository.findById(orderId)
            .orElseThrow(() -> new OrderNotFoundException());
            
        // ë¡œì»¬ ë³µì œ ë°ì´í„° ì¡°íšŒ
        ProductReadModel product = productReadModelRepository
            .findById(order.getProductId())
            .orElse(null);
            
        UserReadModel buyer = userReadModelRepository
            .findById(order.getBuyerId())
            .orElse(null);
            
        UserReadModel seller = userReadModelRepository
            .findById(order.getSellerId())
            .orElse(null);
            
        return OrderDetailResponse.builder()
            .orderId(order.getId())
            .status(order.getStatus())
            .price(order.getPrice())
            // ìŠ¤ëƒ…ìƒ· ë°ì´í„° (ì£¼ë¬¸ ì‹œì )
            .productName(order.getProductName())
            .modelNumber(order.getModelNumber())
            .productOptionName(order.getProductOptionName())
            .productImageUrl(order.getProductImageUrl())
            .brandName(order.getBrandName())
            // í˜„ì¬ ë°ì´í„° (ì½ê¸° ëª¨ë¸)
            .currentProductInfo(product != null ? ProductInfo.from(product) : null)
            .buyerInfo(buyer != null ? UserInfo.from(buyer) : null)
            .sellerInfo(seller != null ? UserInfo.from(seller) : null)
            .build();
    }
    
    /**
     * ì‹¤ì‹œê°„ ë°ì´í„° í•„ìš” ì‹œ (ëŠë¦¼, ê°•í•œ ì¼ê´€ì„±)
     */
    @Autowired
    private ProductClient productClient;
    
    @Autowired
    private UserClient userClient;
    
    public OrderDetailResponse getOrderDetailRealtime(UUID orderId) {
        Order order = orderRepository.findById(orderId)
            .orElseThrow(() -> new OrderNotFoundException());
            
        // ì™¸ë¶€ ì„œë¹„ìŠ¤ í˜¸ì¶œ (ë³‘ë ¬)
        CompletableFuture<ProductResponse> productFuture = 
            CompletableFuture.supplyAsync(() -> 
                productClient.getProduct(order.getProductId())
            );
            
        CompletableFuture<UserResponse> buyerFuture = 
            CompletableFuture.supplyAsync(() -> 
                userClient.getUser(order.getBuyerId())
            );
            
        CompletableFuture<UserResponse> sellerFuture = 
            CompletableFuture.supplyAsync(() -> 
                userClient.getUser(order.getSellerId())
            );
            
        CompletableFuture.allOf(productFuture, buyerFuture, sellerFuture).join();
        
        return OrderDetailResponse.builder()
            .orderId(order.getId())
            .status(order.getStatus())
            .price(order.getPrice())
            .productName(order.getProductName())
            .currentProductInfo(ProductInfo.from(productFuture.join()))
            .buyerInfo(UserInfo.from(buyerFuture.join()))
            .sellerInfo(UserInfo.from(sellerFuture.join()))
            .build();
    }
}
```

---

## ì¶”ì²œ ì•„í‚¤í…ì²˜

### ìµœì¢… ê¶Œì¥ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API Gateway                             â”‚
â”‚                  (Spring Cloud Gateway)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Service  â”‚  â”‚Product Svc  â”‚  â”‚  Order Service  â”‚
â”‚                â”‚  â”‚             â”‚  â”‚                 â”‚
â”‚  - User DB     â”‚  â”‚ - Product DBâ”‚  â”‚  - Order DB     â”‚
â”‚  - Auth        â”‚  â”‚ - Brand     â”‚  â”‚  - Payment      â”‚
â”‚                â”‚  â”‚ - Option    â”‚  â”‚  - Settlement   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚                   â”‚
         â”‚                 â”‚                   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      Message Broker (Kafka)       â”‚
         â”‚  - product-events                 â”‚
         â”‚  - order-events                   â”‚
         â”‚  - user-events                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ Order   â”‚    â”‚ Product â”‚    â”‚  User   â”‚
    â”‚ Service â”‚    â”‚ Service â”‚    â”‚ Service â”‚
    â”‚ (Listen)â”‚    â”‚ (Listen)â”‚    â”‚ (Listen)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì„œë¹„ìŠ¤ë³„ ì±…ì„

#### 1. **User Service**
- ì‚¬ìš©ì ì¸ì¦/ì¸ê°€
- ì‚¬ìš©ì ì •ë³´ ê´€ë¦¬
- ì´ë²¤íŠ¸: UserCreated, UserUpdated, UserDeleted

#### 2. **Product Service**
- ìƒí’ˆ/ë¸Œëœë“œ/ì˜µì…˜ ê´€ë¦¬
- ì¬ê³  ê´€ë¦¬ (í–¥í›„)
- ì´ë²¤íŠ¸: ProductCreated, ProductUpdated, ProductDeleted, ProductOptionCreated

#### 3. **Order Service**
- ì£¼ë¬¸ ìƒì„±/ê´€ë¦¬
- ë°°ì†¡ ì¶”ì 
- ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬
- ì½ê¸° ëª¨ë¸: Product, User (ë³µì œ)
- ì´ë²¤íŠ¸: OrderCreated, OrderStatusChanged, OrderCompleted

#### 4. **Trade Service**
- íŒë§¤/êµ¬ë§¤ ì…ì°° ê´€ë¦¬
- ê°€ê²© ë§¤ì¹­
- ì´ë²¤íŠ¸: SellingBidCreated, SellingBidMatched

#### 5. **Payment Service**
- ê²°ì œ ì²˜ë¦¬
- PG ì—°ë™
- ì •ì‚° ê´€ë¦¬
- ì´ë²¤íŠ¸: PaymentCompleted, PaymentFailed, SettlementCompleted

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬ ì „ í™•ì¸ì‚¬í•­

- [ ] ê° ì„œë¹„ìŠ¤ì˜ ê²½ê³„ê°€ ëª…í™•í•œê°€? (Bounded Context)
- [ ] ì„œë¹„ìŠ¤ ê°„ ìˆœí™˜ ì°¸ì¡°ê°€ ì—†ëŠ”ê°€?
- [ ] ê° ì„œë¹„ìŠ¤ê°€ ë…ë¦½ì ìœ¼ë¡œ ë°°í¬ ê°€ëŠ¥í•œê°€?
- [ ] ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì¸í”„ë¼ê°€ ì¤€ë¹„ë˜ì—ˆëŠ”ê°€?
- [ ] ë¶„ì‚° ì¶”ì  ì‹œìŠ¤í…œì´ êµ¬ì¶•ë˜ì—ˆëŠ”ê°€?
- [ ] ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ê°€ ì„¤ì •ë˜ì—ˆëŠ”ê°€?
- [ ] Circuit Breakerê°€ ì ìš©ë˜ì—ˆëŠ”ê°€?
- [ ] ë³´ìƒ íŠ¸ëœì­ì…˜ ë¡œì§ì´ êµ¬í˜„ë˜ì—ˆëŠ”ê°€?
- [ ] ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íšì´ ìˆ˜ë¦½ë˜ì—ˆëŠ”ê°€?
- [ ] ë¡¤ë°± ê³„íšì´ ìˆëŠ”ê°€?

---

## ì°¸ê³  ìë£Œ

- **Saga Pattern**: https://microservices.io/patterns/data/saga.html
- **CQRS**: https://martinfowler.com/bliki/CQRS.html
- **Event-Driven Architecture**: https://martinfowler.com/articles/201701-event-driven.html
- **Spring Cloud**: https://spring.io/projects/spring-cloud
- **Resilience4j**: https://resilience4j.readme.io/

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2026-01-15  
**ë²„ì „**: 1.0.0  
**ì‘ì„±ì**: UNBOX Development Team
